<mat-spinner *ngIf="loading" class="spinner" diameter="50"></mat-spinner>
<div class="container" *ngIf="!loading">
  <div class="calendar">
    <mat-form-field>
      <mat-label>日付を選択してください</mat-label>
      <input
        matInput
        [matDatepicker]="picker"
        [min]="minDate"
        [max]="maxDate"
        (dateChange)="createGraphByChangingDate($event)"
      />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>
  </div>

  <h3 *ngIf="!legend">{{ graphTitle }}</h3>
  <div class="nav nav--date">
    <button
      class="nav__button"
      mat-stroked-button
      [color]="typeOfGraph === 'day' ? 'primary' : 'black'"
      (click)="createGraphOfDay(today)"
    >
      日
    </button>
    <button
      class="nav__button"
      mat-stroked-button
      [color]="typeOfGraph === 'week' ? 'primary' : 'black'"
      (click)="createGraphOfWeek(today)"
    >
      週
    </button>
    <button
      class="nav__button"
      mat-stroked-button
      [color]="typeOfGraph === 'month' ? 'primary' : 'black'"
      (click)="createGraphOfMonth(today)"
    >
      月
    </button>
    <button
      class="nav__button"
      mat-stroked-button
      [color]="typeOfGraph === 'year' ? 'primary' : 'black'"
      (click)="createGraphOfYear(today)"
    >
      年
    </button>
  </div>
  <div class="graph">
    <ngx-charts-line-chart
      *ngIf="weightGraph && preWeight.length > 0"
      (window:resize)="onResize($event)"
      [view]="view"
      [legendPosition]="legendPosition"
      [scheme]="colorScheme"
      [legend]="legend"
      [legendTitle]="legendWeight"
      [showXAxisLabel]="showXAxisLabel"
      [showYAxisLabel]="showYAxisLabel"
      [xAxis]="xAxis"
      [yAxis]="yAxis"
      [xAxisLabel]="xAxisLabel"
      [yAxisLabel]="yAxisLabel"
      [timeline]="timeline"
      [results]="dataWeight"
    >
    </ngx-charts-line-chart>
    <p class="graph__text" *ngIf="preWeight.length === 0">
      体重の平均データまだはありません
    </p>
    <ngx-charts-line-chart
      *ngIf="fatGraph && preFat.length > 0"
      (window:resize)="onResize($event)"
      [view]="view"
      [legendPosition]="legendPosition"
      [scheme]="colorScheme"
      [legend]="legend"
      [legendTitle]="legendFat"
      [showXAxisLabel]="showXAxisLabel"
      [showYAxisLabel]="showYAxisLabel"
      [xAxis]="xAxis"
      [yAxis]="yAxis"
      [xAxisLabel]="xAxisLabel"
      [yAxisLabel]="yAxisLabel"
      [timeline]="timeline"
      [results]="dataFat"
    >
    </ngx-charts-line-chart>
    <p class="graph__text" *ngIf="preFat.length === 0">
      体脂肪の平均データまだはありません
    </p>
    <ngx-charts-line-chart
      *ngIf="totalCalGraph && preTotalCal.length > 0"
      (window:resize)="onResize($event)"
      [view]="view"
      [legendPosition]="legendPosition"
      [scheme]="colorScheme"
      [legend]="legend"
      [legendTitle]="legendTotalCal"
      [showXAxisLabel]="showXAxisLabel"
      [showYAxisLabel]="showYAxisLabel"
      [xAxis]="xAxis"
      [yAxis]="yAxis"
      [xAxisLabel]="xAxisLabel"
      [yAxisLabel]="yAxisLabel"
      [timeline]="timeline"
      [results]="dataTotalCal"
    >
    </ngx-charts-line-chart>
    <p class="graph__text" *ngIf="preTotalCal.length === 0">
      摂取カロリーの平均データまだはありません
    </p>
  </div>
  <div class="nav nav--category" *ngIf="!legend">
    <button
      class="nav__button"
      mat-stroked-button
      [color]="weightGraph ? 'primary' : 'black'"
      (click)="changeTitle('weight')"
    >
      体重
    </button>
    <button
      class="nav__button"
      mat-stroked-button
      [color]="fatGraph ? 'primary' : 'black'"
      (click)="changeTitle('fat')"
    >
      体脂肪
    </button>
    <button
      class="nav__button"
      mat-stroked-button
      [color]="totalCalGraph ? 'primary' : 'black'"
      (click)="changeTitle('totalCal')"
    >
      カロリー
    </button>
  </div>
</div>
